Tab AEXPORTBE.ExportCreateSql ;
  Declare SQL =  varchar(1000) ;
%if &isWKT = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_Communes_WKT;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_Communes_WKT(' ;Stock;
  SQL = '	geo_id_comm int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	CodeCommune varchar(5) Not NULL,' ;Stock;
  SQL = '	Polygon Geometry,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_comm)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_Communes_WKT ADD INDEX IDX_GEO_Communes_WKT_CodeCommune(CodeCommune);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;
%if &isData = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_Communes_DATA;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_Communes_DATA(' ;Stock;
  SQL = '	geo_id_comm_data int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	CodeCommune varchar(5) Not NULL,' ;Stock;
  SQL = '	CodeCant varchar(5) Not NULL,' ;Stock;
  SQL = '	CodeDept varchar(3) Not NULL,' ;Stock;
  SQL = '	Commune varchar(100) Not NULL,' ;Stock;
  SQL = '	ZoneBE varchar(7) Not NULL,' ;Stock;
  SQL = '	CodeBE varchar(5) Not NULL,' ;Stock;
  SQL = '	TypeZone varchar(10) Not NULL,' ;Stock;
  SQL = '	NB_PIA double NULL,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_comm_data)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_Communes_DATA ADD INDEX IDX_GEO_Communes_DATA_CodeCommune(CodeCommune);' ;Stock;
  SQL = 'ALTER TABLE GEO_Communes_DATA ADD INDEX IDX_GEO_Communes_DATA_CodeDept(CodeDept);' ;Stock;
  SQL = 'ALTER TABLE GEO_Communes_DATA ADD INDEX IDX_GEO_Communes_DATA_ZoneBE(ZoneBE);' ;Stock;
  SQL = 'ALTER TABLE GEO_Communes_DATA ADD INDEX IDX_GEO_Communes_DATA_CodeBE(CodeBE);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;  
%if &isWKT = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_Departements_WKT;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_Departements_WKT(' ;Stock;
  SQL = '	geo_id_dept int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	CodeDept varchar(3) Not NULL,' ;Stock;
  SQL = '	Polygon Geometry,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_dept)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_Departements_WKT ADD INDEX IDX_GEO_Departements_WKT_CodeDept(CodeDept);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;
%if &isData = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_Departements_DATA;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_Departements_DATA(' ;Stock;
  SQL = '	geo_id_dept_data int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	CodeDept varchar(3) Not NULL,' ;Stock;
  SQL = '	Nom varchar(30) NULL,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_dept_data)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_Departements_DATA ADD INDEX IDX_GEO_Departements_DATA_CodeDept(CodeDept);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;  
%if &isWKT = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_EPCI_WKT;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_EPCI_WKT(' ;Stock;
  SQL = '	geo_id_epci int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	EPCI varchar(10) Not NULL,' ;Stock;
  SQL = '	Polygon Geometry,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_epci)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_EPCI_WKT ADD INDEX IDX_GEO_EPCI_WKT_EPCI(EPCI);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;
%if &isData = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_EPCI_DATA;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_EPCI_DATA(' ;Stock;
  SQL = '	geo_id_epci_data int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	EPCI varchar(10) Not NULL,' ;Stock;
  SQL = '	Libelle varchar(255) NULL,' ;Stock;
  SQL = '	Nature varchar(255) NULL,' ;Stock;
  SQL = '	NbCommunes double NULL,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_epci_data)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_EPCI_DATA ADD INDEX IDX_GEO_EPCI_DATA_EPCI(EPCI);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;  
%if &isWKT = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_ZoneBE_WKT;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_ZoneBE_WKT(' ;Stock;
  SQL = '	geo_id_zonebe int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	ZoneBE varchar(7) Not NULL,' ;Stock;
  SQL = '	Polygon Geometry,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_zonebe)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_ZoneBE_WKT ADD INDEX IDX_GEO_ZoneBE_WKT_ZoneBE(ZoneBE);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;
%if &isData = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_ZoneBE_DATA;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_ZoneBE_DATA(' ;Stock;
  SQL = '	geo_id_zonebe_data int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	ZoneBE varchar(7) Not NULL,' ;Stock;
  SQL = '	CodeBE varchar(5) Not NULL,' ;Stock;
  SQL = '	NB_PIA double NULL,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_zonebe_data)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_ZoneBE_DATA ADD INDEX IDX_GEO_ZoneBE_DATA_ZoneBE(ZoneBE);' ;Stock;
  SQL = 'ALTER TABLE GEO_ZoneBE_DATA ADD INDEX IDX_GEO_Coordination_DATA_CodeBE(CodeBE);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;  
%if &isWKT = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_CodeBE_WKT;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_CodeBE_WKT(' ;Stock;
  SQL = '	geo_id_codebe int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	CodeBE varchar(5) Not NULL,' ;Stock;
  SQL = '	Polygon Geometry,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_codebe)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_CodeBE_WKT ADD INDEX IDX_GEO_CodeBE_WKT_CodeBE(CodeBE);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;
%if &isData = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_CodeBE_DATA;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_CodeBE_DATA(' ;Stock;
  SQL = '	geo_id_codebe_data int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	CodeBE varchar(5) Not NULL,' ;Stock;
  SQL = '	NB_PIA double NULL,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_codebe_data)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_CodeBE_DATA ADD INDEX IDX_GEO_CodeBE_DATA_CodeBE(CodeBE);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;  
%if &isWKT = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_ZonageBE_WKT;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_ZonageBE_WKT(' ;Stock;
  SQL = '	geo_id_zonagebe int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	CodeBE varchar(5) Not NULL,' ;Stock;
  SQL = '	Polygon Geometry,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_zonagebe)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_ZonageBE_WKT ADD INDEX IDX_GEO_ZonageBE_WKT_CodeBE(CodeBE);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;
%if &isData = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_ZonageBE_DATA;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_ZonageBE_DATA(' ;Stock;
  SQL = '	geo_id_zonagebe_data int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	CodeBE varchar(5) Not NULL,' ;Stock;
  SQL = '	NB_PIA double NULL,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_zonagebe_data)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_ZonageBE_DATA ADD INDEX IDX_GEO_ZonageBE_DATA_CodeBE(CodeBE);' ;Stock;
%endif ;  

%if &isWKT = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_ZoneVierge_WKT;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_ZoneVierge_WKT(' ;Stock;
  SQL = '	geo_id_zonevierge int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	ZoneBE varchar(7) Not NULL,' ;Stock;
  SQL = '	Polygon Geometry,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_zonevierge)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_ZoneVierge_WKT ADD INDEX IDX_GEO_ZoneVierge_WKT_ZoneBE(ZoneBE);' ;Stock;

  SQL = '' ;Stock;
  SQL = '' ;Stock;
%endif ;
%if &isData = 1 %Then ;
  SQL = 'DROP TABLE IF EXISTS GEO_ZoneVierge_DATA;' ;Stock;
  SQL = 'CREATE TABLE IF Not EXISTS GEO_ZoneVierge_DATA(' ;Stock;
  SQL = '	geo_id_zonevierge_data int(11) Not NULL AUTO_INCREMENT,' ;Stock;
  SQL = '	ZoneBE varchar(7) Not NULL,' ;Stock;
  SQL = '	NB_PIA double NULL,' ;Stock;
  SQL = '	PRIMARY KEY(geo_id_zonevierge_data)' ;Stock;
  SQL = ') ENGINE = MyISAM ;' ;Stock;
  SQL = '' ;Stock;
  SQL = 'ALTER TABLE GEO_ZoneVierge_DATA ADD INDEX IDX_GEO_ZoneVierge_DATA_ZoneBE(ZoneBE);' ;Stock;
%endif ;  

Fintab ;

Proc EXPORT ;
  Table AEXPORTBE.ExportCreateSql ;
  Fichier Extension = 'sql' Librairie = 'AEXPORTBE' Nom = 'Export_GEO_CREATE_TABLES_WKT' Separateur = 'COMMA' NoHeader ; 
Finproc ;